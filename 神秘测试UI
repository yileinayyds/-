repeat
	task.wait()
until game:IsLoaded()
local library = {}
local ToggleUI = false
library.currentTab = nil
library.flags = {}
local services = setmetatable({}, {
	__index = function(t, k)
		return game.GetService(game, k)
	end,
})
local player = services.Players.LocalPlayer
local mouse = player:GetMouse()

function Tween(obj, t, data)
	services.TweenService
		:Create(obj, TweenInfo.new(t[1], Enum.EasingStyle[t[2]], Enum.EasingDirection[t[3]]), data)
		:Play()
	return true
end

function Ripple(obj)
	spawn(function()
		if obj.ClipsDescendants ~= true then
			obj.ClipsDescendants = true
		end
		local Ripple = Instance.new("ImageLabel")
		Ripple.Name = "Ripple"
		Ripple.Parent = obj
		Ripple.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
		Ripple.BackgroundTransparency = 1.000
		Ripple.ZIndex = 8
		Ripple.Image = "rbxassetid://80818864421975"
		Ripple.ImageTransparency = 0.800
		Ripple.ScaleType = Enum.ScaleType.Fit
		Ripple.ImageColor3 = Color3.fromRGB(255, 255, 255)
		Ripple.Position = UDim2.new(
			(mouse.X - Ripple.AbsolutePosition.X) / obj.AbsoluteSize.X,
			0,
			(mouse.Y - Ripple.AbsolutePosition.Y) / obj.AbsoluteSize.Y,
			0
		)
		Tween(
			Ripple,
			{ 0.3, "Linear", "InOut" },
			{ Position = UDim2.new(-5.5, 0, -5.5, 0), Size = UDim2.new(12, 0, 12, 0) }
		)
		wait(0.15)
		Tween(Ripple, { 0.3, "Linear", "InOut" }, { ImageTransparency = 1 })
		wait(0.3)
		Ripple:Destroy()
	end)
end

local toggled = false
local switchingTabs = false

function switchTab(new)
	if switchingTabs then
		return
	end
	local old = library.currentTab
	if old == nil then
		new[2].Visible = true
		library.currentTab = new
		services.TweenService:Create(new[1], TweenInfo.new(0.1), { ImageTransparency = 0 }):Play()
		services.TweenService:Create(new[1].TabText, TweenInfo.new(0.1), { TextTransparency = 0 }):Play()
		return
	end
	if old[1] == new[1] then
		return
	end
	switchingTabs = true
	library.currentTab = new
	services.TweenService:Create(old[1], TweenInfo.new(0.1), { ImageTransparency = 0.2 }):Play()
	services.TweenService:Create(new[1], TweenInfo.new(0.1), { ImageTransparency = 0 }):Play()
	services.TweenService:Create(old[1].TabText, TweenInfo.new(0.1), { TextTransparency = 0.2 }):Play()
	services.TweenService:Create(new[1].TabText, TweenInfo.new(0.1), { TextTransparency = 0 }):Play()
	old[2].Visible = false
	new[2].Visible = true
	task.wait(0.1)
	switchingTabs = false
end

function drag(frame, hold)
	if not hold then
		hold = frame
	end
	local dragging
	local dragInput
	local dragStart
	local startPos
	local function update(input)
		local delta = input.Position - dragStart
		frame.Position =
			UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
	hold.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			dragStart = input.Position
			startPos = frame.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)
	frame.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement then
			dragInput = input
		end
	end)
	services.UserInputService.InputChanged:Connect(function(input)
		if input == dragInput and dragging then
			update(input)
		end
	end)
end

-- 创建固定在角色前方的3D UI
function createCharacterFrontUI()
	-- 等待角色生成
	if not player.Character then
		player.CharacterAdded:Wait()
	end
	
	local character = player.Character
	local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
	
	-- 创建一个固定在角色前方的部件
	local uiAttachmentPart = Instance.new("Part")
	uiAttachmentPart.Name = "UIAttachmentPart"
	uiAttachmentPart.Size = Vector3.new(0.1, 0.1, 0.1)
	uiAttachmentPart.Transparency = 1
	uiAttachmentPart.CanCollide = false
	uiAttachmentPart.Anchored = false
	uiAttachmentPart.Parent = character
	
	-- 使用Weld将部件固定在角色前方
	local weld = Instance.new("Weld")
	weld.Part0 = humanoidRootPart
	weld.Part1 = uiAttachmentPart
	weld.C0 = CFrame.new(0, 0, -2) * CFrame.Angles(0, math.pi, 0) -- 在角色前方2个单位，面向角色
	weld.Parent = uiAttachmentPart
	
	-- 创建SurfaceGui固定在部件上
	local surfaceGui = Instance.new("SurfaceGui")
	surfaceGui.Name = "CharacterFrontUI"
	surfaceGui.Face = Enum.NormalId.Front -- 显示在前方表面
	surfaceGui.AlwaysOnTop = true
	surfaceGui.Enabled = true
	surfaceGui.Parent = uiAttachmentPart
	
	-- 设置SurfaceGui的尺寸（这将决定UI在3D世界中的大小）
	surfaceGui.CanvasSize = Vector2.new(800, 500) -- 你可以根据需要调整
	
	return surfaceGui, uiAttachmentPart
end

-------------------------GHOST TEAM------------------------------
local config = {
    MainColor = Color3.fromRGB(255, 105, 180),  -- 粉色
    TabColor = Color3.fromRGB(255, 182, 193),   -- 浅粉色
    Bg_Color = Color3.fromRGB(255, 192, 203),   -- 粉红色
    Zy_Color = Color3.fromRGB(255, 182, 193),   -- 浅粉色
    
    Button_Color = Color3.fromRGB(255, 192, 203),
    Textbox_Color = Color3.fromRGB(255, 182, 193),
    Dropdown_Color = Color3.fromRGB(255, 192, 203),
    Keybind_Color = Color3.fromRGB(255, 182, 193),
    Label_Color = Color3.fromRGB(255, 192, 203),
    
    Slider_Color = Color3.fromRGB(255, 182, 193),
    SliderBar_Color = Color3.fromRGB(255, 105, 180),  -- 粉色
    
    Toggle_Color = Color3.fromRGB(255, 182, 193),
    Toggle_Off = Color3.fromRGB(220, 180, 200),       -- 浅紫色
    Toggle_On = Color3.fromRGB(255, 105, 180),        -- 粉色
}
-------------------------GHOST TEAM------------------------------

function library.new(library, name, theme)
	-- 创建固定在角色前方的UI
	local YI, uiPart = createCharacterFrontUI()
	
	-- 在屏幕上创建控制按钮（和原始UI一样）
	local screenButton = Instance.new("ScreenGui")
	screenButton.Name = "VRUIControl"
	screenButton.Parent = player:WaitForChild("PlayerGui")
	
	local Open = Instance.new("ImageButton")
	local UICorner = Instance.new("UICorner")

	Open.Name = "Open"
	Open.Parent = screenButton
	Open.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	Open.BackgroundTransparency = 1
	Open.Position = UDim2.new(0.00829315186, 0, 0.13107837, 0)
	Open.Size = UDim2.new(0, 50, 0, 50)
	Open.Active = true
	Open.Draggable = true
	Open.Image = "rbxassetid://80818864421975"
	Open.ImageTransparency = 0
	
	Open.MouseButton1Click:Connect(function()
		YI.Enabled = not YI.Enabled
	end)

	UICorner.Parent = Open
	
	-- 键盘快捷键
	services.UserInputService.InputEnded:Connect(function(input)
		if input.KeyCode == Enum.KeyCode.RightControl then
			YI.Enabled = not YI.Enabled
		end
	end)

	local Main = Instance.new("Frame")
	local Background = Instance.new("ImageLabel")
	local TabMain = Instance.new("Frame")
	local MainC = Instance.new("UICorner")
	local SB = Instance.new("Frame")
	local SBC = Instance.new("UICorner")
	local Side = Instance.new("Frame")
	local SideG = Instance.new("UIGradient")
	local TabBtns = Instance.new("ScrollingFrame")
	local TabBtnsL = Instance.new("UIListLayout")
	local ScriptTitle = Instance.new("TextLabel")
	local SBG = Instance.new("UIGradient")
	local UICornerMain = Instance.new("UICorner")

	function UiDestroy()
		if uiPart then
			uiPart:Destroy()
		end
		if screenButton then
			screenButton:Destroy()
		end
	end
	
	function ToggleUILib()
		YI.Enabled = not YI.Enabled
	end
	
	-- 恢复原始UI样式
	Main.Name = "Main"
	Main.Parent = YI
	Main.AnchorPoint = Vector2.new(0.5, 0.5)
	Main.BackgroundColor3 = Color3.new(0, 0, 0)
	Main.BackgroundTransparency = 1
	Main.BorderSizePixel = 0
	Main.Position = UDim2.new(0.5, 0, 0.5, 0)
	Main.Size = UDim2.new(1, 0, 1, 0) -- 填满整个SurfaceGui
	Main.ZIndex = 1
	Main.Active = true
	
	-- 添加背景图片
	Background.Name = "Background"
	Background.Parent = Main
	Background.BackgroundTransparency = 1
	Background.Size = UDim2.new(1, 0, 1, 0)
	Background.Position = UDim2.new(0, 0, 0, 0)
	Background.Image = "rbxassetid://80818864421975"
	Background.ZIndex = 0
	Background.ScaleType = Enum.ScaleType.Crop

	function toggleui()
		toggled = not toggled
		spawn(function()
			if toggled then
				wait(0.3)
			end
		end)
		Tween(Main, { 0.3, "Sine", "InOut" }, { Size = UDim2.new(0, 609, 0, (toggled and 505 or 0)) })
	end
	
	TabMain.Name = "TabMain"
	TabMain.Parent = Main
	TabMain.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	TabMain.BackgroundTransparency = 1.000
	TabMain.Position = UDim2.new(0.217000037, 0, 0, 3)
	TabMain.Size = UDim2.new(0, 448, 0, 350)
	
	MainC.CornerRadius = UDim.new(0, 5.5)
	MainC.Name = "MainC"
	MainC.Parent = TabMain
	
	SB.Name = "SB"
	SB.Parent = Main
	SB.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	SB.BorderColor3 = config.MainColor
	SB.Size = UDim2.new(0, 8, 0, 353)
	SB.BackgroundTransparency = 1
	
	SBC.CornerRadius = UDim.new(0, 6)
	SBC.Name = "SBC"
	SBC.Parent = SB
	
	Side.Name = "Side"
	Side.Parent = SB
	Side.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	Side.BorderColor3 = Color3.fromRGB(255, 255, 255)
	Side.BorderSizePixel = 0
	Side.ClipsDescendants = true
	Side.Position = UDim2.new(1, 0, 0, 0)
	Side.Size = UDim2.new(0, 110, 0, 353)
	Side.BackgroundTransparency = 1.0
	
	SideG.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0.00, config.Zy_Color), 
    ColorSequenceKeypoint.new(1.00, config.Zy_Color)
})
	SideG.Rotation = 90
	SideG.Name = "SideG"
	SideG.Parent = Side
	
	TabBtns.Name = "TabBtns"
	TabBtns.Parent = Side
	TabBtns.Active = true
	TabBtns.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	TabBtns.BackgroundTransparency = 1.000
	TabBtns.BorderSizePixel = 0
	TabBtns.Position = UDim2.new(0, 0, 0.0973535776, 0)
	TabBtns.Size = UDim2.new(0, 110, 0, 318)
	TabBtns.CanvasSize = UDim2.new(0, 0, 1, 0)
	TabBtns.ScrollBarThickness = 0
	
	TabBtnsL.Name = "TabBtnsL"
	TabBtnsL.Parent = TabBtns
	TabBtnsL.SortOrder = Enum.SortOrder.LayoutOrder
	TabBtnsL.Padding = UDim.new(0, 12)
	
	ScriptTitle.Name = "ScriptTitle"
	ScriptTitle.Parent = Side
	ScriptTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	ScriptTitle.BackgroundTransparency = 1.000
	ScriptTitle.Position = UDim2.new(0, 0, 0.00953488424, 0)
	ScriptTitle.Size = UDim2.new(0, 102, 0, 20)
	ScriptTitle.Font = Enum.Font.GothamSemibold
	ScriptTitle.Text = name
	ScriptTitle.TextColor3 = Color3.fromRGB(255, 105, 180)
	ScriptTitle.TextSize = 14.000
	ScriptTitle.TextScaled = true
	ScriptTitle.TextXAlignment = Enum.TextXAlignment.Left

	SBG.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0.00, config.Zy_Color), 
    ColorSequenceKeypoint.new(1.00, config.Zy_Color)
})
	SBG.Rotation = 90
	SBG.Name = "SBG"
	SBG.Parent = SB
	
	UICornerMain.Parent = Main
	UICornerMain.CornerRadius = UDim.new(0, 3)
	
	TabBtnsL:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		TabBtns.CanvasSize = UDim2.new(0, 0, 0, TabBtnsL.AbsoluteContentSize.Y + 18)
	end)
	
	-- 窗口对象创建代码（和原始版本完全一样）
	local window = {}
	
	function window.Tab(window, name, icon)
		-- 这里插入原始版本的Tab创建代码
		-- 完全保持原来的UI样式和功能
		
		-- ... [原始Tab创建代码] ...
		
		return tab
	end
	
	return window
end

return library
